---
wps_internal_hostname: rook4.cloud.dkrz.de
#wps_external_hostname: compute.mips.copernicus-climate.eu
wps_external_hostname: rook4.cloud.dkrz.de

# user for pywps service
wps_user: wps
wps_group: wps
## TODO: allow user wps to run cron
# $ vim /etc/security/access.conf
# + : wps : cron crond :0 tty1 tty2 tty3 tty4 tty5 tty6

# enable cronjob to clean outputs
cron_mailto: ehbrecht@dkrz.de
cron_disabled: no
wps_outputs_keep_days: 3
wps_temp_keep_days: 3
# conda
conda_env_use_spec: true
conda_env_spec_file: spec-list.txt
# conda_env_file: env.yml
# db
db_install_postgresql: true
db_host: "136.172.60.158"
postgresql_pg_hba_md5_hosts: ['136.172.60.158/32']
db_install_sqlite: false
db_user: pywps
db_password: pywps
# gunicorn
gunicorn_workers: 17 
gunicorn_worker_class: 'gevent'
# slurm
slurm_enabled: true
# access control
wps_enable_acl: false
wps_acl_allow:
   - 136.172.0.0/16  # dkrz
   #- 136.172.60.0/16  
   - 136.156.132.0/23
   - 130.246.130.0/24
   - 130.246.148.0/24
   - 172.17.11.15
# roocs
roocs_enabled: true
roocs_site: dkrz
wps_services:
  - name: rook
    repo: https://github.com/roocs/rook.git
    version: fix-intake-filemapper
    hostname: "{{ wps_external_hostname }}"
    fs_hostname: "{{ wps_internal_hostname }}"
    port: 80
    mode: scheduler
    # drmaa_native_specification: "--share -N 1-2"
    maxprocesses: -1
    parallelprocesses: -1
    storage_copy_function: link
    log_level: INFO
    identification_accessconstraints: "open access"
    provider_name: "rook (intake)"
    provider_url: http://rook.dkrz.de
    contact_name: DKRZ
    contact_city: Hamburg
    contact_country: Germany
    contact_url: https://roocs.github.io/
    cleantempdir: false
    environment:
      INTAKE_CONF_DIR: /var/lib/pywps/intake 
